<!DOCTYPE html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ID Card Generator</title>
        <style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
            }

            body {
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                padding: 20px;
            }

            .container {
                background: white;
                border-radius: 20px;
                box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
                padding: 40px;
                max-width: 600px;
                width: 100%;
                text-align: center;
            }

            .logo {
                font-size: 2.5rem;
                font-weight: bold;
                color: #333;
                margin-bottom: 10px;
            }

            .subtitle {
                color: #666;
                margin-bottom: 30px;
                font-size: 1.1rem;
            }

            .generate-btn {
                background: linear-gradient(45deg, #667eea, #764ba2);
                color: white;
                border: none;
                padding: 15px 30px;
                border-radius: 50px;
                font-size: 1.1rem;
                font-weight: bold;
                cursor: pointer;
                transition: all 0.3s ease;
                margin-bottom: 20px;
                min-width: 200px;
            }

            .generate-btn:hover {
                transform: translateY(-2px);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            }

            .generate-btn:disabled {
                opacity: 0.6;
                cursor: not-allowed;
                transform: none;
            }

            .loading {
                display: none;
                margin: 20px 0;
            }

            .spinner {
                border: 4px solid #f3f3f3;
                border-top: 4px solid #667eea;
                border-radius: 50%;
                width: 40px;
                height: 40px;
                animation: spin 1s linear infinite;
                margin: 0 auto;
            }

            @keyframes spin {
                0% {
                    transform: rotate(0deg);
                }
                100% {
                    transform: rotate(360deg);
                }
            }

            .result {
                display: none;
                margin-top: 30px;
            }

            .id-card {
                border: 2px solid #ddd;
                border-radius: 10px;
                max-width: 100%;
                height: auto;
                box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            }

            .download-btn {
                background: #28a745;
                color: white;
                border: none;
                padding: 10px 20px;
                border-radius: 25px;
                font-size: 1rem;
                cursor: pointer;
                margin-top: 15px;
                transition: all 0.3s ease;
            }

            .download-btn:hover {
                background: #218838;
                transform: translateY(-1px);
            }

            .error {
                color: #dc3545;
                background: #f8d7da;
                border: 1px solid #f5c6cb;
                border-radius: 5px;
                padding: 10px;
                margin: 10px 0;
                display: none;
            }

            .info {
                background: #d1ecf1;
                border: 1px solid #bee5eb;
                border-radius: 5px;
                padding: 15px;
                margin: 20px 0;
                color: #0c5460;
            }

            .timer {
                font-size: 0.9rem;
                color: #666;
                margin-top: 10px;
            }

            @media (max-width: 768px) {
                .container {
                    padding: 20px;
                    margin: 10px;
                }

                .logo {
                    font-size: 2rem;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="logo">üÜî ID Card Generator</div>
            <div class="subtitle">T·∫°o ID card v·ªõi th√¥ng tin ng·∫´u nhi√™n</div>

            <div class="info">
                <strong>L∆∞u √Ω:</strong> M·ªói l·∫ßn t·∫°o ID card s·∫Ω c√°ch nhau √≠t nh·∫•t
                30 gi√¢y ƒë·ªÉ tr√°nh spam.
            </div>

            <button
                class="generate-btn"
                onclick="generateIdCard()"
                id="generateBtn"
            >
                üé≤ T·∫°o ID Card M·ªõi
            </button>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>ƒêang t·∫°o ID card...</p>
            </div>

            <div class="error" id="error"></div>

            <div class="result" id="result">
                <h3>ID Card ƒë√£ ƒë∆∞·ª£c t·∫°o:</h3>
                <img class="id-card" id="idCardImage" alt="Generated ID Card" />
                <br />
                <button class="download-btn" onclick="downloadImage()">
                    üì• T·∫£i xu·ªëng
                </button>
            </div>

            <div class="timer" id="timer"></div>
        </div>

        <script>
            let lastGenerateTime = 0
            const COOLDOWN_TIME = 30000 // 30 gi√¢y
            let currentImageUrl = ''

            function showError(message) {
                const errorDiv = document.getElementById('error')
                errorDiv.textContent = message
                errorDiv.style.display = 'block'
                setTimeout(() => {
                    errorDiv.style.display = 'none'
                }, 5000)
            }

            function showLoading(show) {
                const loading = document.getElementById('loading')
                const generateBtn = document.getElementById('generateBtn')

                if (show) {
                    loading.style.display = 'block'
                    generateBtn.disabled = true
                    generateBtn.textContent = '‚è≥ ƒêang t·∫°o...'
                } else {
                    loading.style.display = 'none'
                    generateBtn.disabled = false
                    generateBtn.textContent = 'üé≤ T·∫°o ID Card M·ªõi'
                }
            }

            function updateTimer() {
                const now = Date.now()
                const timeSinceLastGenerate = now - lastGenerateTime
                const remainingTime = Math.max(
                    0,
                    COOLDOWN_TIME - timeSinceLastGenerate
                )

                const timerDiv = document.getElementById('timer')
                const generateBtn = document.getElementById('generateBtn')

                if (remainingTime > 0) {
                    const seconds = Math.ceil(remainingTime / 1000)
                    timerDiv.textContent = `‚è∞ C√≥ th·ªÉ t·∫°o ID card m·ªõi sau ${seconds} gi√¢y`
                    generateBtn.disabled = true
                } else {
                    timerDiv.textContent = ''
                    generateBtn.disabled = false
                }
            }

            function startTimer() {
                setInterval(updateTimer, 1000)
            }

            async function generateIdCard() {
                const now = Date.now()
                const timeSinceLastGenerate = now - lastGenerateTime

                if (timeSinceLastGenerate < COOLDOWN_TIME) {
                    const remainingSeconds = Math.ceil(
                        (COOLDOWN_TIME - timeSinceLastGenerate) / 1000
                    )
                    showError(
                        `Vui l√≤ng ƒë·ª£i ${remainingSeconds} gi√¢y n·ªØa ƒë·ªÉ t·∫°o ID card m·ªõi.`
                    )
                    return
                }

                showLoading(true)
                document.getElementById('error').style.display = 'none'
                document.getElementById('result').style.display = 'none'

                try {
                    // S·ª≠ d·ª•ng API backend (c√≥ th·ªÉ l√† Vercel, Netlify, ho·∫∑c service kh√°c)
                    const response = await fetch(
                        'https://your-backend-api.vercel.app/api/create-id-card',
                        {
                            method: 'GET',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                        }
                    )

                    if (!response.ok) {
                        throw new Error(
                            `HTTP error! status: ${response.status}`
                        )
                    }

                    const data = await response.json()

                    if (data.success && data.imageUrl) {
                        currentImageUrl = data.imageUrl
                        const img = document.getElementById('idCardImage')
                        img.src = data.imageUrl
                        document.getElementById('result').style.display =
                            'block'
                        lastGenerateTime = now
                    } else {
                        throw new Error(data.message || 'Kh√¥ng th·ªÉ t·∫°o ID card')
                    }
                } catch (error) {
                    console.error('Error:', error)
                    showError(
                        'C√≥ l·ªói x·∫£y ra khi t·∫°o ID card. Vui l√≤ng th·ª≠ l·∫°i sau.'
                    )
                } finally {
                    showLoading(false)
                }
            }

            function downloadImage() {
                if (currentImageUrl) {
                    const link = document.createElement('a')
                    link.href = currentImageUrl
                    link.download = 'id-card.png'
                    document.body.appendChild(link)
                    link.click()
                    document.body.removeChild(link)
                }
            }

            // Kh·ªüi t·∫°o timer khi trang load
            document.addEventListener('DOMContentLoaded', function () {
                startTimer()
            })
        </script>
    </body>
</html>
